# ProfileFragment & Avatar 功能测试清单

## 测试环境
- Android设备/模拟器: API 26+
- 后端服务: 需要运行并可访问
- 测试账号: 至少2个用户账号

---

## 📱 ProfileFragment 测试

### 1. 用户信息显示 ✓
- [ ] 登录后进入Profile页面
- [ ] 验证显示的用户名是否正确（非"Alex Chen"）
- [ ] 验证显示的是displayName（如果有）或username

### 2. 头像显示 ✓
- [ ] **场景A: 无头像用户**
  - 应显示首字母
  - 背景颜色基于用户名hash生成
  
- [ ] **场景B: 默认头像用户**
  - 应显示对应颜色背景+首字母
  - 颜色与选择的默认头像一致
  
- [ ] **场景C: HTTP URL头像用户**
  - 应显示网络图片
  - 图片应为圆形

### 3. 头像更换功能 ✓
- [ ] 点击头像
- [ ] 弹出3个选项的对话框：
  - "选择默认头像"
  - "从相册选择"
  - "取消"

#### 3.1 选择默认头像
- [ ] 点击"选择默认头像"
- [ ] 显示5种颜色选项（蓝、绿、紫、橙、粉）
- [ ] 选择一种颜色
- [ ] Toast提示"头像更新成功"
- [ ] 头像立即显示为所选颜色+首字母
- [ ] 重启应用后头像保持不变

#### 3.2 从相册选择
- [ ] 点击"从相册选择"
- [ ] 打开系统图片选择器
- [ ] 选择一张图片
- [ ] Toast提示"头像更新成功"
- [ ] 头像应更新（注意：当前实现可能不完全支持本地图片）

### 4. 统计数据显示 ✓
- [ ] **测试前提**: 需要有活跃的账本和交易记录
- [ ] **我垫付的**: 
  - 创建几笔由自己垫付的交易
  - 检查金额是否正确累计
  - 格式应为 "¥X,XXX.XX"
- [ ] **我的消费**:
  - 参与其他人垫付的交易
  - 检查自己应付金额是否正确
  - 格式应为 "¥X,XXX.XX"

### 5. 退出功能 ✓
- [ ] 点击"退出登录"
- [ ] 显示确认对话框
- [ ] 点击"确定"
- [ ] 应返回登录页面
- [ ] 再次打开应用应显示登录页面

- [ ] 点击"退出应用"
- [ ] 显示确认对话框
- [ ] 点击"确定"
- [ ] 应用应完全关闭

---

## 🏠 DashboardFragment 测试

### 1. 室友状态显示 ✓
- [ ] 创建或加入一个有多个成员的账本
- [ ] 进入Dashboard页面
- [ ] 检查"Roommate Status"区域

### 2. 头像加载 ✓
- [ ] **初始状态**: 应立即显示所有室友的首字母
- [ ] **1-2秒后**: 头像应更新为真实头像（如果有）
- [ ] **多种头像类型验证**:
  - 至少1个用户使用默认头像
  - 至少1个用户使用HTTP URL头像
  - 至少1个用户无头像（显示首字母）

### 3. 状态颜色保留 ✓
- [ ] 设置不同用户的状态：
  - AVAILABLE (绿色)
  - BUSY (红色)
  - AWAY (橙色)
  - ASLEEP (灰色)
- [ ] 验证头像加载后，状态颜色是否保留（对于无HTTP URL头像的用户）

### 4. 点击交互 ✓
- [ ] 点击自己的头像 → 应打开状态选择对话框
- [ ] 点击其他人的头像 → 应Toast显示该用户的状态

---

## 🌐 网络异常处理测试

### 1. 无网络环境
- [ ] 关闭网络连接
- [ ] 进入ProfileFragment
- [ ] 应显示Toast"加载用户信息失败"
- [ ] 界面不应崩溃

### 2. 服务器错误
- [ ] 关闭后端服务
- [ ] 进入ProfileFragment
- [ ] 应有适当的错误提示
- [ ] DashboardFragment应保持显示首字母

### 3. 图片加载失败
- [ ] 设置一个无效的HTTP URL作为头像
- [ ] 应降级显示首字母
- [ ] 不应显示破损图片图标

---

## 🔄 数据一致性测试

### 1. 多设备同步
- [ ] 设备A: 更新头像为头像A
- [ ] 设备B: 登录同一账号
- [ ] 设备B应显示头像A
- [ ] 设备B更新为头像B
- [ ] 设备A刷新后应显示头像B

### 2. 账本切换
- [ ] 加入多个账本
- [ ] 在Dashboard切换账本
- [ ] 室友头像应正确更新为当前账本成员
- [ ] Profile统计数据应更新为当前账本数据

---

## 📊 性能测试

### 1. 头像加载性能
- [ ] 加入一个有10+成员的账本
- [ ] 观察Dashboard加载时间
- [ ] 所有头像应在5秒内加载完成
- [ ] 不应出现卡顿

### 2. 内存使用
- [ ] 多次进入/退出ProfileFragment
- [ ] 观察内存使用情况
- [ ] 不应有明显内存泄漏

---

## 🐛 边界情况测试

### 1. 特殊用户名
- [ ] 测试单字符用户名（如"A"）
- [ ] 测试空displayName（应降级显示username）
- [ ] 测试emoji用户名

### 2. 特殊金额
- [ ] 测试¥0.00的情况
- [ ] 测试超大金额（如¥999,999.99）
- [ ] 测试负数balance

### 3. 并发操作
- [ ] 快速连续点击头像
- [ ] 在头像上传中退出页面
- [ ] 同时更新头像和修改用户信息

---

## ✅ 通过标准

### 功能完整性
- ✅ 所有核心功能正常工作
- ✅ 错误处理得当
- ✅ 数据持久化正确

### 用户体验
- ✅ 响应速度快（<2秒）
- ✅ 无明显卡顿
- ✅ Toast提示清晰

### 稳定性
- ✅ 无崩溃
- ✅ 无ANR（Application Not Responding）
- ✅ 网络异常处理良好

---

## 📝 测试记录

**测试日期**: __________  
**测试人员**: __________  
**设备型号**: __________  
**Android版本**: __________

### 发现的问题
| ID | 严重程度 | 问题描述 | 复现步骤 | 状态 |
|----|---------|---------|---------|------|
| 1  |         |         |         |      |
| 2  |         |         |         |      |
| 3  |         |         |         |      |

### 测试结论
- [ ] 通过 - 可发布
- [ ] 通过 - 有minor issues
- [ ] 不通过 - 需要修复

**备注**: 
